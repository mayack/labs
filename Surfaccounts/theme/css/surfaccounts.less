/**
 * Agile CSS Framework
 * http://css.agiletoolkit.org/
 */

@import '../../agile-css/agiletoolkit.less';
@import 'libs/jquery-ui.css';
@import 'libs/select2.min.css';
@import url(https://fonts.googleapis.com/css?family=PT+Sans:400,700|Open+Sans:400,600,400italic,700,600italic,700italic);
@import (less) 'fontello.css'; /* Icon library generated by www.fontello.com */


// ==========================================================
// Typography
// ==========================================================

@bodyFamily:           "Open Sans", "Helvetica Neue", "Helvetica", sans-serif;
@bodySize:             0.8125rem; // 12px
@bodyBaseline:         1.618;

@headingCase:          none; // Options: none, capitalize, uppercase, lowercase
@headingFamily:        "PT Sans", "Helvetica Neue", "Helvetica", sans-serif;
@headingWeight:        700;
@headingBaseline:      1.2; // Minor Third

@fontScatter:          0.5; // Multiplier that affects difference between heading sizes


// ==========================================================
// Swatches
// ==========================================================

.createSmartSwatch(
    @sName:            default,
    @sFill:            #fff,
    @sHeading:         @ink,
    @sText:            @ink,
    @sComment:         @gray,
    @sLink:            @aqua,
    @sBorderIntensity: 5%,
    @sBorder:          #dadde0,
    @sCustomStyles:    {
      .border-black {
        border-color: @sText !important;
      }
      .select2-container--default .select2-selection--single {
          border-color: @sBorderActive;
      }
      .select2-dropdown {
        border-color: @sBorderOverlay;
      }
      .invoice-table table {
        tbody tr td, thead tr th {
          border-color: @sBorder !important;
        }
        tbody tr {
          &:not(:last-child) td {
            border-bottom-color: @sBorderDisabled !important;
            border-top-color: @sBorderDisabled !important;
          }
        }
      }
    }
);
.createSmartSwatch(
    @sName:            night,
    @sFill:            @night,
    @sHoverIntensity:  3%
);
.createSmartSwatch(
    @sName:            midnight,
    @sFill:            @midnight,
    @sText:            #fff,
    @sLink:            #fff,
    @sLinkHover:       #fff,
    @sHoverIntensity:  3%
);
.createSmartSwatch(
    @sName:            gray,
    @sFill:            @lightGray
);
.createSmartSwatch(
    @sName:            smoke,
    @sFill:            @smoke
);
.createSmartSwatch(
    @sName:            aqua,
    @sFill:            @aqua,
    @sHoverIntensity:  3%
);
.createSmartSwatch(
    @sName:            mint,
    @sFill:            @mint
);


// ==========================================================
// Styles & Colors
// ==========================================================

@bodyBackground:       @smoke;
@cornerRadius:         5px;
@textSelect:           @midnight;
@dialogOverlay:        fade(#000, 25%);
@tooltipColor:         fade(@midnight, 90%);
@popoverArrow:         12px;
@buttonPadding:        0.5em;
@buttonPaddingRatio:   1.5;

@effectSuccess:        @mint;
@effectWarning:        @orange;
@effectDanger:         @red;
@effectInfo:           @aqua;

@inputColor:           #fff;
@inputText:            @black;
@inputFocus:           @aqua;
@inputFocusGlow:       0;
@inputPadding:         0.5em;
@inputPaddingRatio:    2.5;
@inputPlaceholder:     @gray;
@inputInnerShadow:     0 3px 0 rgba(0, 0, 0, 0.03) inset;


// ==========================================================
// Custom
// ==========================================================

@black:       #1f2326;
@ink:         #525c66;
@darkGray:    #737980;
@gray:        #8c949c;
@lightGray:   #acb5bf;
@smoke:       #f3f4f5;

@night:       #24323e;
@midnight:    #2f3f4d;
@aqua:        #00b5d9;
@mint:        #46bc99;
@orange:      #f7a600;
@red:         #ff5533;

// Layout
body, html {
  overflow-y: hidden;
}
.atk-layout {
  .content {
    height: 100%;
    overflow: auto;
  }
}
#sidebar {
  @navExpandedColor: shade(@aqua, 7%);
  @sidebarWidth: 12rem;
  .position(relative, @z:2);
  .transition(~"width .3s, min-width .3s");
  min-width: @sidebarWidth;
  overflow: hidden;
  width: @sidebarWidth;
  text-shadow: 0 2px 0 rgba(0,0,0,0.1);
  #sidebar-inner {
    .position(@t:0, @l:0);
    height: 100%;
    width: 100%;
    #logo {
      position: relative;
      #logo-mask {
        .position(@t:0,@r:0);
        .transition(.3s);
        height: 100%;
        pointer-events: none;
        width: 70px;
      }
      a {
        .position(relative, @l:-7px);
        .transition(left .3s);
      }
    }
    #nav-sidebar {
      .transition(height .3s);
      >ul {
        line-height: 1;
        li {
          .transition(background .7s);
          background: fade(@navExpandedColor,0%);
          &.active a, &.has-active:not(.opened)>a {
            &, &:hover {
              box-shadow: 3px 0 0 0 #fff inset;
              color: #fff;
            } 
          }
          &.opened {
            background: @navExpandedColor;
            .icon-angle-right:before {
              .rotate(90deg);
            }
          }
        }
        >li {
          a {
            .transition(~"box-shadow .5s, padding .3s, color .2s");
            box-shadow: 3px 0 0 0 fade(#fff,0%) inset;
            span {
              .transition(opacity .2s);
            }
            .icon-angle-right:before {
              .transition(.2s);
            }
          }
          >a {
            .atk-text-size--l;
            font-weight: 700;
            padding: @space-s @space-xs @space-s @space;
            *[class*="icon"]:not([class*="angle"]) {
              .atk-text-size--xxl;
            }
            *[class*="icon-angle"] {
              .atk-text-size--l;
            }
          }
          >ul {
            display: none;
            font-weight: 600;
            overflow: hidden;
            padding-left: 0;
            padding-top: 0;
            li {
              a {
                padding: @space-xs @space;
              }
              &:last-child {
                margin-bottom: @space-s;
              }
            }
          }
        }
      }
    }
    footer {
      .transition(.5s);
      background: transparent;
      cursor: pointer;
      width: 100%;
      .footer-expanded, .footer-collapsed {
        .position(@b:0,@l:0);
        .transition(opacity .5s);
        hr {
          .position(@t:-1px,@l:0);
          width: 100%;
        }
        &.swatch-midnight:hover {
          background: @navExpandedColor;
        }
      }
      .footer-expanded {
        min-width: @sidebarWidth;
        z-index: 1;
      }
      .footer-collapsed {
        line-height: 1;
        padding-left: 0 !important;
        padding-right: 0 !important;
        text-align: center;
        width: 100%;
        z-index: 2;
      }
      >.atk-cells {
        position: relative;
      }
    }
  }
  &, .expanded {
    #sidebar-expanded;
  }
  &.collapsed {
    #sidebar-collapsed;
  }
}
#sidebar-trigger {
  position: relative;
  >* {
    .transition(opacity .3s);
  }
  .icon-menu {
    .position(@t:50%,@l:50%);
    line-height: 1;
    margin: -0.5em 0 0 -0.5em;
  }
  &, .expanded {
    #sidebar-trigger-expanded();
  }
  &.collapsed {
    #sidebar-trigger-collapsed();
  }
}
#nav-main ul.atk-menu-vertical li a {
  padding: @space-s;
  .icon-plus {
    .atk-text-size--xs;
    margin-right: @space-xs;
  }
}

// Styles
.text-darkGray {
  color: @darkGray;
  a&:not([class*="atk-button"]):not([class*="atk-swatch"]), a:not([class*="atk-button"]):not([class*="atk-swatch"]) {
    color: @darkGray;
    &:hover {
      color: darken(@darkGray, 15%);
    }
  }
}

// Objects
.invoice-table {
  thead tr th {
    padding: @space-xs/2 !important;
  }
  tbody tr td {
    .select2-container--default .select2-selection--single {
      background: none;
      border: none;
      border-radius: 0;
      .select2-selection__rendered {
        padding: 0.3em 0.4em;
      }
      // .select2-selection__arrow {
      //   display: none;
      // }
    }
    input {
      .border-radius(0~'!important');
      .box-shadow(none~'!important');
      background: none !important;
      border: none !important;
      display: inline-block;
      width: 100%;
    }
    .select2-container--default.select2-container--open, input:focus {
      background: #fff !important;
      box-shadow: 0 0 0 2px @inputFocus !important;
      position: relative;
      z-index: 2;
    }
  }
}
.select2-dropdown.invoice-dropdown {
  .atk-text-size--s;
  ul.select2-results__options {
    li.select2-results__option {
      padding-bottom: 0.3em;
      padding-left: 0.4em;
      padding-top: 0.3em;
    }
  }
  &.select2-dropdown--above {
    margin-top: -2px;
  }
  &.select2-dropdown--below {
    margin-top: 2px;
  }
}
[class*="invoice-status"] {
  .position(@t:45px,@r:45px);
  .rotate(45deg);
  color: #fff;
  height: 30px;
  line-height: 30px;
  text-align: center;
  margin: -15px -100px 0 0;
  width: 200px;
  &[class*="invoice-status--success"] {
    background: @mint;
  }
  &[class*="invoice-status--warning"] {
    background: @orange;
  }
  &[class*="invoice-status--danger"] {
    background: @red;
  }
}
.page-actions {
  .position(relative,@z:2);
}
.file-browser {
  position: relative;
  input {
    .position(@t:0,@l:0);
    visibility: hidden;
  }
}
.popover-actions.atk-box {
  padding: 0;
  z-index: 10;
  ul li {
    a.atk-swatch-default:not([class*="atk-button"]) {
      display: block;
      color: @ink;
      overflow: hidden;
      padding: @space-xs @space-s;
      white-space: nowrap;
      &:before {
        &:extend(.icon-ok:before);
        .atk-text-size--xs;
        display: none;
        float: right;
        font-family: fontello;
        margin: 0.3em 0 0 @space;
      }
    }
    &:first-child a {
      &:extend(.atk-shape-rounded--top);
    }
    &:last-child a {
      &:extend(.atk-shape-rounded--bottom);
    }
    &.active a.atk-swatch-default:not([class*="atk-button"]) {
      color: @aqua;
      &:before {
        display: block;
      }

    }
  }
}

// Amendments
.select2-dropdown, .ui-datepicker, [class*="atk-popover-"], .ui-dialog {
  .elementShadow;
}
[class*="atk-table"]:not(.invoice-table) {
  table {
    thead, tbody {
      tr:first-child {
        th, td {
          &:first-child {
            &:extend(.atk-shape-rounded--top--left);
          }
          &:last-child {
            &:extend(.atk-shape-rounded--top--right);
          }
        }
      }
    }
    thead + tbody tr:first-child {
      td:first-child, td:last-child {
        &:extend(.atk-shape-rectangle);
      }
    }
    tbody tr {
      .atk-tableAction {
        a {
          .transition(.3s);
        }
        &.visible {
          opacity: 1 !important;
          a, a:hover {
            background: @darkGray !important;
            border-color: @darkGray !important;
            color: #fff !important;
          }
        }
      }
      &:last-child td {
        &:first-child {
          &:extend(.atk-shape-rounded--bottom--left);
        }
        &:last-child {
          &:extend(.atk-shape-rounded--bottom--right);
        }
      }
    }
  }
}

// jQueryUI
.ui-dialog {
  // border: none;
  .ui-widget-header.ui-dialog-titlebar {
    background: @smoke;
    text-align: center;
  }
  .dialog-scrollable {
    max-height: 280px !important;
    overflow: auto;
  }
}
.ui-tabs.tabs-minimal {
  background: none !important;
  ul.ui-tabs-nav {
    border: none;
    margin-bottom: @space-s !important;
    li.ui-state-default {
      background: none !important;
      border: none;
      border-radius: 0;
      margin: 0;
      a:not([class*="atk-button"]):not([class*="atk-swatch"]) {
        color: @gray;
        &:hover {
          color: darken(@gray, 15%);
        }
        &:not([class*="atk-inputLabel"]) {
          padding: @space-xs 0;
        }
      }
      + li {
        margin-left: @space;
      }
      &.ui-state-active {
        box-shadow: 0 -2px 0 @inputFocus inset;
        padding-bottom: 0;
      }
    }
  }
  .ui-tabs-panel.ui-widget-content {
    border: none;
    padding: 0;
  }
}
.ui-datepicker {
  margin: 4px 0;
  z-index: 999 !important;
}

// Misc
.scrollable {
  overflow-y: auto;
}
.disable {
  pointer-events: none;
}
textarea {
  resize: none;
}

// Select2
.select2-container--default {
  .select2-dropdown.select2-dropdown--above {
    .select2-results__option {
      &:first-child {
        &:extend(.atk-shape-rounded--top);
      }
    }
  }
  .select2-dropdown.select2-dropdown--below {
    .select2-results__option {
      &:last-child {
        &:extend(.atk-shape-rounded--bottom);
      }
    }
  }
  .select2-results__option {
    padding: @inputPadding;
    padding-right: 2em;
    white-space: nowrap;
  }
  .select2-results__option[aria-selected=true] {
    .icon-generator('\e81d');
    background: none;
    color: @aqua !important;
    &:before {
      .atk-text-size--xs;
      left: auto;
      right: 0.6em;
    }
  }
  .select2-results__option--highlighted[aria-selected] {
    background-color: @smoke;
    color: inherit;
    position: relative;
  }
  .select2-selection--single {
    border-radius: @cornerRadius;
    height: auto;
    .select2-selection__rendered {
      color: @black;
      line-height: @bodyBaseline;
      padding: @inputPadding;
      padding-right: 2em;
      text-align: left;
    }
    .select2-selection__arrow {
      height: 100%;
      right: 0;
      top: 0;
      width: 1.8em;
      b {
        .position(@t:0, @l:0);
        .icon-generator('\e8b0');
        border: none;
        color: @gray;
        height: 100%;
        margin: 0;
        position: absolute !important;
        width: 100%;
      }
    }
  }
  &.select2-container--open {
    .select2-selection--single {
      border-color: @inputFocus;
    }
  }
}

// Mixins
.elementShadow() {
  .box-shadow(0 5px 15px fade(@midnight, 15%));
}
#sidebar-expanded() {
  #sidebar-indicator {
    display: block;
  }
  @sidebarWidth: 12rem;
  min-width: @sidebarWidth;
  width: @sidebarWidth;
  #sidebar-inner {
    #logo {
      a {
        left: -7px;
      }
      #logo-mask {
        opacity: 0;
      }
    }
    #nav-sidebar {
      ul>li {
        >a {
          padding-left: @space;
          >span {
            opacity: 1;
          }
        }
      }
    }
    footer {
      .footer-expanded {
        pointer-events: auto;
        opacity: 1;
      }
      .footer-collapsed {
        pointer-events: none;
        opacity: 0;
      }
    }
  }
}
#sidebar-collapsed() {
  #sidebar-indicator {
    display: none;
  }
  @sidebarWidth: 3.35rem;
  min-width: @sidebarWidth;
  width: @sidebarWidth;
  #sidebar-inner {
    #logo {
      a {
        left: -10px;
      }
      #logo-mask {
        opacity: 1;
      }
    }
    #nav-sidebar {
      ul>li {
        >a {
          padding-left: @margin/1.5 !important;
          >span:not(:first-child) {
            opacity: 0;
          }
        }
      }
    }
    footer {
      .footer-expanded {
        pointer-events: none;
        opacity: 0;
      }
      .footer-collapsed {
        pointer-events: auto;
        opacity: 1;
      }
    }
  }
}
#sidebar-trigger-expanded() {
  .icon-collapse-left {
    opacity: 1;
  }
  .icon-menu {
    opacity: 0;
  }
}
#sidebar-trigger-collapsed() {
  .icon-collapse-left {
    opacity: 0;
  }
  .icon-menu {
    opacity: 1;
  }
}


// ==========================================================
// Responsive
// ==========================================================

// Important: list .createViewport functions in the right order based on @min and @max values otherwise styles get overridden
.createViewport(
    @wrapperMargin:    3rem,
    @colsGutter:       2rem,
    @cols:             12,
    @viewportMinWidth: 1025px,
    @wrapperMinWidth:  54rem,
    @wrapperMaxWidth:  54rem,
    @customStyle: {
      #sidebar {
        #sidebar-expanded;
      }
      #sidebar-trigger {
        #sidebar-trigger-expanded;
      }
    }
);
.createViewport(
    @wrapperMargin:    3rem,
    @colsGutter:       2rem,
    @cols:             12,
    @viewportMinWidth: 0,
    @viewportMaxWidth: 1024px,
    @wrapperMinWidth:  54rem,
    @wrapperMaxWidth:  54rem,
    @customStyle: {
      #sidebar:not(.expanded) {
        #sidebar-collapsed;
      }
      #sidebar-trigger:not(.expanded) {
        #sidebar-trigger-collapsed;
      }
    }
);